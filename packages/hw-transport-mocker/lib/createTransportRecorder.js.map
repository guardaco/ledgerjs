{"version":3,"sources":["../src/createTransportRecorder.js"],"names":["DecoratedTransport","recordStore","TransportRecorder","transport","close","t","apdu","output","exchange","then","recordExchange","out","isSupported","list","listen","open"],"mappings":";;;;;;;;AACA;;;;;;;;;;;;kBAEe,UACbA,kBADa,EAEbC,WAFa,EAGW;AAAA,MAClBC,iBADkB;AAAA;;AAAA;AAAA;AAAA,uCAOL,CAAE;AAPG;AAAA;AAAA,8BAQd;AACN,eAAO,KAAKC,SAAL,CAAeC,KAAf,EAAP;AACD;AAVqB;;AAYtB,+BAAYC,CAAZ,EAAe;AAAA;;AAAA;;AAEb,YAAKF,SAAL,GAAiBE,CAAjB;AAFa;AAGd;;AAfqB;AAAA;AAAA,+BAgBbC,IAhBa,EAgBkB;AACtC,YAAMC,SAAS,KAAKJ,SAAL,CAAeK,QAAf,CAAwBF,IAAxB,CAAf;AACAC,eAAOE,IAAP,CAAY,eAAO;AACjBR,sBAAYS,cAAZ,CAA2BJ,IAA3B,EAAiCK,GAAjC;AACD,SAFD;AAGA,eAAOJ,MAAP;AACD;AAtBqB;;AAAA;AAAA;;AAClBL,mBADkB,CAEfU,WAFe,GAEDZ,mBAAmBY,WAFlB;AAClBV,mBADkB,CAGfW,IAHe,GAGRb,mBAAmBa,IAHX;AAClBX,mBADkB,CAIfY,MAJe,GAINd,mBAAmBc,MAJb;;AAClBZ,mBADkB,CAKfa,IALe,GAKR;AAAA,WACZf,mBAAmBe,IAAnB,sCAAiCN,IAAjC,CAAsC;AAAA,aAAK,IAAIP,iBAAJ,CAAsBG,CAAtB,CAAL;AAAA,KAAtC,CADY;AAAA,GALQ;;AAwBxB,SAAOH,iBAAP;AACD,C","file":"createTransportRecorder.js","sourcesContent":["//@flow\nimport Transport from \"@ledgerhq/hw-transport\";\nimport type RecordStore from \"./RecordStore\";\nexport default (\n  DecoratedTransport: Class<Transport<*>>,\n  recordStore: RecordStore\n): Class<Transport<*>> => {\n  class TransportRecorder extends Transport<*> {\n    static isSupported = DecoratedTransport.isSupported;\n    static list = DecoratedTransport.list;\n    static listen = DecoratedTransport.listen;\n    static open = (...args) =>\n      DecoratedTransport.open(...args).then(t => new TransportRecorder(t));\n    setScrambleKey() {}\n    close() {\n      return this.transport.close();\n    }\n    transport: Transport<*>;\n    constructor(t) {\n      super();\n      this.transport = t;\n    }\n    exchange(apdu: Buffer): Promise<Buffer> {\n      const output = this.transport.exchange(apdu);\n      output.then(out => {\n        recordStore.recordExchange(apdu, out);\n      });\n      return output;\n    }\n  }\n  return TransportRecorder;\n};\n"]}